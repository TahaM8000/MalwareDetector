import os
import random
import string
from functions import *
from Check import *
import shutil
#--------------------------------------------------------------------
def separate_malwares(path):
    malware_path = os.path.join(path, 'Malwares')
    if not os.path.exists(malware_path):
        os.makedirs(malware_path)

    
    count_malwares = 0
    for file_name in os.listdir(path):
        if(file_name == "Malwares"):
            continue
        file_path = os.path.join(path, file_name)
        if checkFile(file_path):
            count_malwares += 1
            shutil.move(file_path, malware_path)


    return count_malwares
#--------------------------------------------------------------------
path = 'testFile/test1'
all = count_files(path)
countMalware = separate_malwares(path)



#--------------------------------------------------------------------
print("Report :  ")
print(f"Malware  {countMalware}")
print(f"Clean files  {all - countMalware}")
print(f"All  {all}")

    