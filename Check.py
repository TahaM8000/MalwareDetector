from Rabin import *
import binascii
from Patterns import *



malwares  = ReadPatterns("PatternsBank.txt")


def checkFile(path):
    
    with open(path, 'rb') as f:
        data = f.read()

    # hex1 = (binascii.hexlify(data)).decode().upper()

    for mal in malwares:
        hex1 = (binascii.hexlify(data[0:malwares[mal].number])).decode().upper()
        for pat in malwares[mal].patterns:
            if(rabinSearch(pat, hex1) != -1):
                return True


    return False


